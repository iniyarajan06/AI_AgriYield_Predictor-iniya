<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriPredict ‚Äî AI-Driven Agricultural Yield Forecasting</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    :root{
      --green:#2ECC71; --gold:#F1C40F; --bg:#0E1410; --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{font-family:Inter, Poppins, system-ui, -apple-system, 'Segoe UI', Roboto; background:linear-gradient(160deg,#071012 0%, #0e1410 100%); color:#e6f0ea; margin:0; -webkit-font-smoothing:antialiased;}

    /* floating particle background with enhanced glow */
    .bg-anim{position:fixed; inset:0; z-index:0; overflow:hidden;}
    .wave{position:absolute; inset:-10% -20%; 
      background: 
        radial-gradient(circle at 20% 30%, rgba(46,204,113,0.08), transparent 15%),
        radial-gradient(circle at 80% 70%, rgba(241,196,15,0.06), transparent 15%),
        radial-gradient(circle at 50% 50%, rgba(46,204,113,0.03), transparent 50%);
      animation: slowHue 18s linear infinite;
      filter:blur(20px)
    }
    @keyframes slowHue{0%{filter:hue-rotate(0deg) blur(20px)}50%{filter:hue-rotate(30deg) blur(20px)}100%{filter:hue-rotate(0deg) blur(20px)}}
    .particles{position:absolute; inset:0; z-index:0;}
    .particle{position:absolute; width:6px; height:6px; background:rgba(46,204,113,0.06); border-radius:50%; animation:float 10s linear infinite;}
    @keyframes float{0%{transform:translateY(0) translateX(0)}100%{transform:translateY(-120vh) translateX(40px)}}

    /* nav */
    header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg, rgba(14,20,16,0.6), rgba(14,20,16,0.35));backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.03)}
    .nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:14px 20px;gap:12px}
    .logo{text-transform:none;font-weight:800;font-size:20px;display:flex;align-items:center;gap:10px}
    .logo .brand{background:linear-gradient(90deg,var(--green),var(--gold));-webkit-background-clip:text;background-clip:text;color:transparent;animation:brandHue 4s linear infinite}
    @keyframes brandHue{0%{filter:hue-rotate(0deg)}50%{filter:hue-rotate(30deg)}100%{filter:hue-rotate(0deg)}}
    nav ul{display:flex;gap:18px;list-style:none;padding:0;margin:0;align-items:center}
    nav a{color:#cfe9d6;text-decoration:none;padding:8px 10px;border-radius:6px;position:relative}
    nav a:hover{color:white}
    .nav-right{display:flex;align-items:center;gap:12px}
  .btn{background:linear-gradient(90deg,var(--green), #16a34a);color:#062417;padding:10px 16px;border-radius:12px;font-weight:800;border:none;cursor:pointer;box-shadow:0 12px 36px rgba(16,185,129,0.18);transition:transform .18s ease, box-shadow .18s;border:1px solid rgba(255,255,255,0.06)}
  .btn:hover{transform:translateY(-3px);box-shadow:0 18px 48px rgba(16,185,129,0.22)}
  /* make ghost button more visible on top of image */
  .btn-ghost{border:1px solid rgba(255,255,255,0.08);color:#e6f0ea;padding:10px 14px}

    /* nav tracker */
    .nav-wrap{position:relative;display:flex;align-items:center}
    .nav-tracker{position:absolute;height:3px;background:linear-gradient(90deg,var(--gold),var(--green));border-radius:3px;bottom:-1px;transition:all .3s cubic-bezier(.2,.9,.23,1);box-shadow:0 0 15px rgba(46,204,113,0.2)}

    /* hero */
  .hero{max-width:1200px;margin:20px auto 10px;padding:40px 20px;display:grid;grid-template-columns:1fr 420px;gap:32px;align-items:center;position:relative;z-index:2;border-radius:12px;overflow:hidden;background:linear-gradient(180deg, rgba(4,8,6,0.6), rgba(4,8,6,0.25)), url('assets/agri-bg.svg') center/cover no-repeat;background-size:cover}
  /* dark overlay so content and buttons stay readable on top of the background image */
  /* hero overlay uses CSS variables so JS can tune opacity when a photo background is used */
  .hero::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg, rgba(4,8,6,var(--hero-overlay-a,0.65)), rgba(4,8,6,var(--hero-overlay-b,0.45)));pointer-events:none;z-index:1}
  .hero > *{position:relative;z-index:2}
  .hero-left h1{font-size:36px;line-height:1.2;letter-spacing:-0.5px;margin:0 0 12px;text-shadow:0 0 30px rgba(46,204,113,0.25);position:relative}
  .hero-left h1::after{content:'';position:absolute;inset:0;background:radial-gradient(circle at 50% 50%, rgba(46,204,113,0.1), transparent 70%);filter:blur(14px);z-index:-1}
  .hero-left p{color:#d6ead8;margin:0 0 16px}
    .cta-row{display:flex;gap:12px;align-items:center}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;color:#d8ead7}

    /* glass card */
  .glass{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.05);box-shadow:0 14px 40px rgba(2,6,3,0.55);padding:18px;border-radius:14px;backdrop-filter:blur(6px)}

    /* dashboard */
    #dashboard{max-width:1200px;margin:40px auto;padding:20px;z-index:2}
    .tabs{display:flex;gap:10px;margin-bottom:18px}
    .tab{padding:10px 14px;border-radius:10px;background:var(--glass);cursor:pointer;color:#dff2e4;font-weight:700}
    .tab.active{background:linear-gradient(90deg,var(--green),var(--gold));color:#06160f}
    .tab-content{min-height:260px;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}

    /* inputs and cards */
    .grid-2{display:grid;grid-template-columns:1fr 360px;gap:18px}
    .input-row{display:flex;gap:8px;margin-bottom:12px}
    .input{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#dff2e4}

    /* chart container */
    .chart-wrap{height:260px}

    /* progress bars */
    .progress{background:var(--glass-2);border-radius:10px;padding:8px}
    .progress-bar{height:12px;background:linear-gradient(90deg,var(--green),var(--gold));border-radius:8px;width:0%;transition:width 1.2s ease}

    /* footer */
    footer{max-width:1200px;margin:40px auto;padding:20px;color:#94a3b8}

    /* responsive */
    @media(max-width:900px){
      .hero{grid-template-columns:1fr;padding:36px 16px}
      .hero-left h1{font-size:28px}
      .hero-left p, .hero-left ul{font-size:14px}
      .hero-left ul{display:none}
      .grid-2{grid-template-columns:1fr}
      .nav ul{display:none}
      .hamburger{display:block}
    }
    .hamburger{display:none;cursor:pointer}

    /* mic pulse */
    .mic{width:56px;height:56px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:linear-gradient(90deg,var(--green),#22c66a);box-shadow:0 10px 28px rgba(46,204,113,0.12);cursor:pointer}
    .mic.pulse::after{content:'';position:absolute;width:80px;height:80px;border-radius:50%;background:rgba(46,204,113,0.08);animation:micPulse 1.5s infinite}
    @keyframes micPulse{0%{transform:scale(0.4);opacity:0.7}70%{transform:scale(1);opacity:0}100%{opacity:0}}

    /* small touches */
    .small{font-size:13px;color:#cfe9d6}

  /* decorative elements */
  #tractor{position:fixed;left:-260px;bottom:18px;z-index:40;pointer-events:none;opacity:0.95;transform:translate3d(0,0,0)}
  .side-farmer{position:fixed;right:20px;bottom:20px;z-index:39;width:180px;height:auto;animation:floatAnimation 3s ease-in-out infinite}
  @keyframes floatAnimation {
    0% { transform:translateY(0px) }
    50% { transform:translateY(-10px) }
    100% { transform:translateY(0px) }
  }
  @media(max-width:900px){
    #tractor{width:110px;height:auto;left:-180px;bottom:12px}
    .side-farmer{width:120px;right:10px;bottom:10px}
  }

  /* stronger button styles when using a photo background */
  .photo-bg .btn{box-shadow:0 20px 60px rgba(16,185,129,0.24)}
  .photo-bg .btn-ghost{background:rgba(255,255,255,0.03);border-color:rgba(255,255,255,0.09)}

  </style>
</head>
<body>
  <div class="bg-anim">
    <div class="wave"></div>
    <div class="particles" id="particlesBG"></div>
  </div>

  <header>
    <div class="nav">
      <div class="logo"><span style="font-size:22px">üåæ</span> <span class="brand">AgriPredict</span></div>
      <div class="nav-wrap">
        <nav>
          <ul id="navList">
            <li><a href="#home" data-target="home">Home</a></li>
            <li><a href="#about" data-target="about">About</a></li>
            <li><a href="#features" data-target="features">Features</a></li>
            <li><a href="#dashboard" data-target="dashboard">Dashboard</a></li>
            <li><a href="#contact" data-target="contact">Contact</a></li>
          </ul>
        </nav>
        <div class="nav-tracker" id="navTracker" style="width:60px; left:120px"></div>
      </div>

      <div class="nav-right">
        <div class="hamburger" id="hamb"> <i class="fa fa-bars"></i></div>
        <button class="btn btn-login">Login</button>
        <button class="btn" id="signupBtn">Sign Up</button>
      </div>
    </div>
  </header>

  <main>
  <!-- decorative elements -->
  <img src="assets/ca59846685c58c8bb05d1d899a017276.jpg" alt="Farmer" class="side-farmer" id="sideFarmer">
    <div id="tractor" aria-hidden="true">
      <!-- Simple inline SVG tractor -->
      <svg viewBox="0 0 200 100" width="160" height="80" xmlns="http://www.w3.org/2000/svg">
        <g fill="none" fill-rule="evenodd">
          <rect x="8" y="30" width="120" height="36" rx="6" fill="#2f855a" />
          <rect x="88" y="10" width="50" height="30" rx="6" fill="#1f6f4a" />
          <circle cx="40" cy="72" r="18" fill="#111" />
          <circle cx="40" cy="72" r="10" fill="#f6f6f6" />
          <circle cx="130" cy="72" r="26" fill="#111" />
          <circle cx="130" cy="72" r="12" fill="#f6f6f6" />
          <rect x="18" y="20" width="8" height="8" rx="2" fill="#f1c40f" />
          <rect x="60" y="38" width="6" height="6" rx="1" fill="#07321a" />
        </g>
      </svg>
    </div>
    <section id="home" class="hero">
      <div class="hero-left">
        <h1 id="heroTitle">üåæ AgriPredict ‚Äì Smart Farming with Artificial Intelligence</h1>
        <p class="small">Empowering farmers with data-driven insights for a sustainable future.</p>

        <p style="margin-top:12px;color:#cfe9d6;line-height:1.5">AgriPredict is an AI-powered agriculture platform designed to help farmers, researchers, and policymakers predict crop yield, analyze weather patterns, and optimize farming decisions. Using advanced machine learning algorithms, climate analytics, and soil-crop data integration, AgriPredict transforms raw data into actionable intelligence for improved productivity and environmental sustainability.</p>

        <div style="margin-top:14px">
          <strong class="small">üå± Key Features</strong>
          <ul class="small" style="margin-top:8px;line-height:1.6">
            <li>AI-Based Crop Yield Prediction: Predict crop outcomes using soil, weather, and crop parameters.</li>
            <li>Smart Dashboard: Visualize real-time analytics through interactive charts and data cards.</li>
            <li>Weather-Aware Recommendations: Get dynamic insights on rainfall, humidity, and temperature patterns.</li>
            <li>Automated Data Processing: Integrates datasets for seamless machine-learning-based predictions.</li>
            <li>Multi-Language & Voice Support: Accessible for rural communities and small farmers.</li>
          </ul>
        </div>

        <div class="cta-row" style="margin-top:18px">
          <button class="btn" id="getStarted">Get Started</button>
          <button class="btn-ghost">Learn More</button>
        </div>

        <p class="small" style="margin-top:12px;color:#bcd9c4"><strong>Tagline:</strong> ‚ÄúCultivating Intelligence for a Greener Tomorrow üå±‚Äù</p>
      </div>

      <div class="glass" aria-hidden="true">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
          <div>
            <div class="small">Today</div>
            <div style="font-weight:800;font-size:20px">AI Forecast Ready</div>
          </div>
          <div class="small">Live ‚Ä¢ <strong style="color:var(--green)">Connected</strong></div>
        </div>
        <div class="chart-wrap">
          <canvas id="miniChart"></canvas>
        </div>
      </div>
    </section>

    <section id="about" style="max-width:1200px;margin:20px auto;padding:24px" class="glass reveal">
      <h3 style="font-size:28px;margin-bottom:16px">About AgriPredict</h3>
      <div style="display:grid;grid-template-columns:1fr;gap:20px">
        <div class="glass" style="padding:20px">
          <p class="small" style="font-size:15px;line-height:1.6;margin:0">AgriPredict is an AI-powered agriculture platform designed to help farmers, researchers, and policymakers predict crop yield, analyze weather patterns, and optimize farming decisions.</p>
          <p class="small" style="margin-top:12px;line-height:1.6">Using advanced machine learning algorithms, climate analytics, and soil-crop data integration, AgriPredict transforms raw data into actionable intelligence for improved productivity and environmental sustainability. The platform focuses on enhancing decision-making, reducing resource waste, and supporting sustainable initiatives at scale.</p>
        </div>

      <h4 style="margin-top:12px">Why Choose AgriPredict?</h4>
      <ul class="small" style="line-height:1.6">
        <li>Enhances decision-making with accurate, AI-generated forecasts.</li>
        <li>Helps reduce resource waste and improve yield per acre.</li>
        <li>Supports government and agri-tech organizations in sustainable farming initiatives.</li>
        <li>Scalable and open-source platform adaptable for various regions and crops.</li>
      </ul>

      <div style="margin-top:12px" class="small"><strong>üåæ Powered By</strong> ‚Äî Python ¬∑ Scikit-Learn ¬∑ Pandas ¬∑ Flask ¬∑ HTML ¬∑ CSS ¬∑ JavaScript</div>
    </section>

    <section id="features" style="max-width:1200px;margin:20px auto;padding:24px" class="glass reveal">
      <h3 style="margin-bottom:16px">üåü Advanced Features</h3>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px">
        <div class="glass" style="padding:16px">
          <h4 style="margin:0 0 8px;color:var(--green)">ü§ñ AI-Powered Analytics</h4>
          <ul class="small" style="margin:0;padding-left:20px;line-height:1.6">
            <li>Advanced yield forecasting using machine learning</li>
            <li>Real-time crop health monitoring</li>
            <li>Predictive analytics for optimal harvesting</li>
            <li>Automated pest and disease detection</li>
          </ul>
        </div>
        
        <div class="glass" style="padding:16px">
          <h4 style="margin:0 0 8px;color:var(--gold)">üìä Smart Dashboard</h4>
          <ul class="small" style="margin:0;padding-left:20px;line-height:1.6">
            <li>Interactive data visualization</li>
            <li>Real-time weather integration</li>
            <li>Customizable charts and reports</li>
            <li>Historical yield analysis</li>
          </ul>
        </div>
        
        <div class="glass" style="padding:16px">
          <h4 style="margin:0 0 8px;color:var(--green)">üéØ Precision Farming</h4>
          <ul class="small" style="margin:0;padding-left:20px;line-height:1.6">
            <li>Smart fertilizer recommendations</li>
            <li>Soil health monitoring</li>
            <li>Water management optimization</li>
            <li>Resource utilization tracking</li>
          </ul>
        </div>
        
        <div class="glass" style="padding:16px">
          <h4 style="margin:0 0 8px;color:var(--gold)">üîä Accessibility</h4>
          <ul class="small" style="margin:0;padding-left:20px;line-height:1.6">
            <li>Voice-assisted input and control</li>
            <li>Multi-language support</li>
            <li>Offline capability</li>
            <li>Mobile-friendly interface</li>
          </ul>
        </div>
      </div>
      
      <div style="margin-top:20px;padding:16px" class="glass">
        <h4 style="margin:0 0 8px">üèÜ Why Choose Our Features?</h4>
        <p class="small" style="margin:0;line-height:1.6">Our comprehensive feature set combines cutting-edge AI technology with user-friendly interfaces, making advanced agricultural analytics accessible to farmers of all technical levels. From precise yield predictions to smart resource management, we provide all the tools needed for modern, efficient farming.</p>
      </div>
    </section>

    <section id="dashboard" style="padding:20px" aria-label="Dashboard">
      <div id="dashboard" class="reveal">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px">
          <div style="display:flex;align-items:center;gap:12px">
            <div class="tabs" id="tabs">
              <div class="tab active" data-tab="inputs">Input Parameters üå±</div>
              <div class="tab" data-tab="results">Prediction Results üìà</div>
              <div class="tab" data-tab="factors">Factor Impact üî¨</div>
              <div class="tab" data-tab="future">Future Trends üìä</div>
              <div class="tab" data-tab="recommend">Smart Recommendations ü§ñ</div>
            </div>
          </div>
          <div style="display:flex;gap:12px;align-items:center">
            <div class="small">AI Tracker</div>
            <div class="ai-indicator" style="width:10px;height:10px;border-radius:50%;background:var(--green);box-shadow:0 4px 18px rgba(46,204,113,0.18)"></div>
            <button id="generatePdfBtn" class="btn" title="Export dashboard as PDF">üìÑ Generate PDF</button>
          </div>
        </div>

        <div class="tab-content" id="tabContent">
          <!-- Inputs -->
          <div class="tab-pane" id="inputs" style="display:block">
            <div class="grid-2">
              <div>
                <label class="small">Crop</label>
                <input id="cropInput" class="input" placeholder="e.g., rice" />

                <div style="display:flex;gap:8px;margin-top:10px">
                  <div style="flex:1">
                    <label class="small">Nitrogen (N)</label>
                    <input id="nVal" type="number" class="input" value="50" />
                  </div>
                  <div style="flex:1">
                    <label class="small">Phosphorus (P)</label>
                    <input id="pVal" type="number" class="input" value="40" />
                  </div>
                  <div style="flex:1">
                    <label class="small">Potassium (K)</label>
                    <input id="kVal" type="number" class="input" value="60" />
                  </div>
                </div>

                <div style="display:flex;gap:8px;margin-top:12px">
                  <div style="flex:1">
                    <label class="small">Temperature (¬∞C)</label>
                    <input id="tempVal" type="number" class="input" value="25" />
                  </div>
                  <div style="flex:1">
                    <label class="small">Rainfall (mm)</label>
                    <input id="rainVal" type="number" class="input" value="220" />
                  </div>
                </div>

                <div style="margin-top:14px;display:flex;gap:10px;align-items:center">
                  <div class="mic" id="micBtn" title="Voice input (crop)"><i class="fa fa-microphone" style="color:#06160f"></i></div>
                  <button class="btn" id="runPredict">Run Predict</button>
                  <button class="btn btn-ghost" id="resetBtn">Reset</button>
                </div>

              </div>
              <div>
                <h4 class="small">NPK Status</h4>
                <div class="progress" style="margin-bottom:8px"><div class="small">Nitrogen <strong id="nPerc">50%</strong></div><div class="progress-bar" id="nBar"></div></div>
                <div class="progress" style="margin-bottom:8px"><div class="small">Phosphorus <strong id="pPerc">40%</strong></div><div class="progress-bar" id="pBar"></div></div>
                <div class="progress" style="margin-bottom:8px"><div class="small">Potassium <strong id="kPerc">60%</strong></div><div class="progress-bar" id="kBar"></div></div>

                <div style="margin-top:18px" class="glass">
                  <div class="small">Recent Prediction</div>
                  <div style="font-weight:800;font-size:22px;margin-top:6px" id="lastPredict">- kg/ha</div>
                </div>

              </div>
            </div>
          </div>

          <!-- Results -->
          <div class="tab-pane" id="results" style="display:none">
            <div style="display:flex;gap:12px;align-items:center">
              <div style="flex:1">
                <div class="glass" style="padding:12px">
                  <div class="small">Expected Yield</div>
                  <div style="font-weight:800;font-size:28px;margin-top:6px" id="expYield">- kg/ha</div>
                  <div class="small" id="expRange">Range: -</div>
                </div>
              </div>
              <div style="width:320px">
                <div class="glass"><canvas id="resultsChart" height="160"></canvas></div>
              </div>
            </div>
          </div>

          <!-- Factors -->
          <div class="tab-pane" id="factors" style="display:none">
            <div class="glass">
              <div class="small">Factor Impact</div>
              <div id="factorsList" style="margin-top:10px"></div>
            </div>
          </div>

          <!-- Future -->
          <div class="tab-pane" id="future" style="display:none">
            <div class="glass">
              <div class="small">Future Trends (2025 - 2030)</div>
              <div style="margin-top:12px"><canvas id="futureTrend" height="200"></canvas></div>
            </div>
          </div>

          <!-- Recommendations -->
          <div class="tab-pane" id="recommend" style="display:none">
            <div class="glass">
              <div class="small">Smart Recommendations</div>
              <ul id="recommendList" class="small" style="margin-top:8px"></ul>
            </div>
          </div>

        </div>
      </div>
    </section>

    <section id="contact" style="max-width:1200px;margin:30px auto;padding:24px" class="glass reveal">
      <h3 style="margin-bottom:16px">üìß Contact Us</h3>
      <div class="glass" style="padding:20px">
        <p class="small" style="margin:0 0 12px">Get in touch with us for:</p>
        <ul class="small" style="margin:0 0 16px;line-height:1.6">
          <li>Product demos and trials</li>
          <li>Integration support</li>
          <li>Enterprise licensing</li>
          <li>Technical assistance</li>
        </ul>
        <div style="display:flex;align-items:center;gap:8px;margin-top:16px">
          <i class="fa fa-envelope" style="color:var(--green)"></i>
          <a href="mailto:iniyarajan06@gmail.com" style="color:var(--green);text-decoration:none" class="small">iniyarajan06@gmail.com</a>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div style="max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center">
      <div class="small">¬© AgriPredict 2025</div>
      <div class="small">Built with ‚ù§Ô∏è for smarter farming</div>
    </div>
  </footer>

<script>
// small particle scatter
const pContainer = document.getElementById('particlesBG');
for(let i=0;i<40;i++){const d=document.createElement('div');d.className='particle';d.style.left=Math.random()*100+'%';d.style.top=Math.random()*100+'%';d.style.opacity=Math.random()*0.5;d.style.transform='scale('+ (0.5+Math.random()) +')';d.style.animationDuration=(8+Math.random()*8)+'s';pContainer.appendChild(d)}

// Mini sparkline in hero
const miniCtx = document.getElementById('miniChart').getContext('2d');
new Chart(miniCtx,{type:'line',data:{labels:[1,2,3,4,5,6],datasets:[{data:[3200,3300,3100,3350,3400,3500],borderColor:'#10b981',backgroundColor:'rgba(16,185,129,0.08)',tension:0.3}]},options:{responsive:true,plugins:{legend:{display:false}},elements:{point:{radius:0}},scales:{x:{display:false},y:{display:false}}}})

// navigation tracker + smooth scroll
const navLinks = document.querySelectorAll('#navList a');
const tracker = document.getElementById('navTracker');
function updateTracker(el){const r=el.getBoundingClientRect();const parent=document.querySelector('header .nav');const left=r.left-parent.getBoundingClientRect().left;tracker.style.left=(left)+'px';tracker.style.width=(r.width)+'px'}
navLinks.forEach(a=>{a.addEventListener('click',e=>{e.preventDefault();document.querySelector('#'+a.dataset.target).scrollIntoView({behavior:'smooth',block:'start'});updateTracker(a)})})
window.addEventListener('load',()=>{ updateTracker(navLinks[0]); 
  // brief tractor drive on first load to restore playful transition behavior
  try{ setTimeout(()=>{ animateTractor(); }, 700); }catch(e){}
});

// highlight current section on scroll
const sections = document.querySelectorAll('main > section');
const observer = new IntersectionObserver((entries)=>{
  entries.forEach(en=>{
    if(en.isIntersecting){
      const id = en.target.id;
      const active = document.querySelector('#navList a[data-target="'+id+'"]');
      if(active){
        navLinks.forEach(n=>n.classList.remove('active'));
        active.classList.add('active');
        updateTracker(active);
      }
    }
  })
}, { threshold: 0.45 });
sections.forEach(s=>observer.observe(s));

// hero title animated letters via GSAP
gsap.registerPlugin(ScrollTrigger);
const title = document.getElementById('heroTitle');
// Use Array.from to correctly handle emoji and unicode characters so we don't get stray replacement characters
const letters = Array.from(title.textContent.trim());
title.innerHTML = letters.map(l=>{
  if(l === ' ') return '<span style="display:inline-block;opacity:0">&nbsp;</span>';
  return `<span style="display:inline-block;opacity:0">${l}</span>`
}).join('');
gsap.to(title.querySelectorAll('span'),{opacity:1,y:0,duration:0.8,stagger:0.03,delay:0.2, ease:'power2.out', from:{y:10}})

// tab switching
const tabs = document.querySelectorAll('.tab');
const panes = document.querySelectorAll('.tab-pane');
tabs.forEach(t=>t.addEventListener('click',()=>{tabs.forEach(x=>x.classList.remove('active')); t.classList.add('active'); const name=t.dataset.tab; panes.forEach(p=>{ if(p.id===name){ p.style.display='block'; gsap.fromTo(p,{x:40,opacity:0},{x:0,opacity:1,duration:0.5}) } else { p.style.display='none' } }) }))

// animation helper: move tractor across screen for a quick playful transition
function animateTractor(){
  const tractor = document.getElementById('tractor');
  if(!tractor) return;
  const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
  gsap.killTweensOf(tractor);
  gsap.set(tractor,{x:-260, opacity:1});
  gsap.to(tractor,{x: vw + 200, duration:1.1, ease:'power2.inOut', onComplete:()=>{ gsap.to(tractor,{opacity:0,duration:0.25,delay:0.1}) }});
}

// wire tractor to nav and tabs
navLinks.forEach(a=>{ a.addEventListener('click',()=>{ try{ animateTractor(); }catch(e){} }) })
tabs.forEach(t=>{ t.addEventListener('click',()=>{ try{ animateTractor(); }catch(e){} }) })

// initial chart setups
const resCtx = document.getElementById('resultsChart').getContext('2d');
const resultsChart = new Chart(resCtx,{type:'bar',data:{labels:['A','B','C','D','E'],datasets:[{label:'Yield factors',data:[10,20,15,25,18],backgroundColor:'#2ecc71'}]},options:{plugins:{legend:{display:false}}}})

const futureCtx = document.getElementById('futureTrend').getContext('2d');
const futureChart = new Chart(futureCtx,{type:'line',data:{labels:['2025','2026','2027','2028','2029','2030'],datasets:[{label:'Projected yield',data:[3300,3400,3550,3600,3700,3850],borderColor:'#f1c40f',backgroundColor:'rgba(241,196,15,0.08)',tension:0.3,fill:true}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:false}}}})

// run predict - simple heuristic based on landing UI
function runPredict(){const n=Number(document.getElementById('nVal').value);const p=Number(document.getElementById('pVal').value);const k=Number(document.getElementById('kVal').value);const temp=Number(document.getElementById('tempVal').value);const rain=Number(document.getElementById('rainVal').value);
 const base = ((n/140)*0.25 + (p/145)*0.2 + (k/205)*0.2 + Math.min(rain/300,1)*0.15 + (1 - Math.abs(temp-25)/25)*0.1 )
 const cropMul = 3500; const yVal=Math.round(base*cropMul);
 document.getElementById('expYield').textContent = yVal + ' kg/ha'; document.getElementById('expRange').textContent = 'Range: '+Math.round(yVal*0.85)+' - '+Math.round(yVal*1.15)+' kg/ha'; document.getElementById('lastPredict').textContent = yVal+' kg/ha';
 // update NPK bars
 document.getElementById('nPerc').textContent = Math.round(n)+'%'; document.getElementById('pPerc').textContent = Math.round(p)+'%'; document.getElementById('kPerc').textContent = Math.round(k)+'%';
 gsap.to('#nBar',{width: Math.min(100,n)+'%'}); gsap.to('#pBar',{width: Math.min(100,p)+'%'}); gsap.to('#kBar',{width: Math.min(100,k)+'%'});
 // update future chart to start from this prediction
 const baseYear = new Date().getFullYear(); const labels=['2025','2026','2027','2028','2029','2030']; let cur=yVal; const vals = labels.map(()=>{ cur=Math.round(cur*(1+(Math.random()-0.4)*0.05)); return cur }); futureChart.data.datasets[0].data = vals; futureChart.update();
 // factors list
 const factors = {Nitrogen:((n/140)*100).toFixed(1), Phosphorus:((p/145)*100).toFixed(1), Potassium:((k/205)*100).toFixed(1), Rainfall:(Math.min(rain/300,1)*100).toFixed(1), Temperature:((1 - Math.abs(temp-25)/25)*100).toFixed(1)};
 const fcont = document.getElementById('factorsList'); fcont.innerHTML=''; Object.entries(factors).forEach(([k1,v])=>{ const div=document.createElement('div');div.className='small';div.innerHTML=`<div style="display:flex;justify-content:space-between"><span>${k1}</span><strong>${v}%</strong></div><div class="progress" style="margin-top:6px"><div class="progress-bar" style="width:0%" data-fill="${v}"></div></div>`; fcont.appendChild(div) });
 // animate factor bars
 document.querySelectorAll('#factorsList .progress-bar').forEach(bar=>{gsap.to(bar,{width:bar.dataset.fill+'%',duration:1.2,ease:'power2.out'})})
 // update results chart
 resultsChart.data.datasets[0].data = [factors.Nitrogen,factors.Phosphorus,factors.Potassium,factors.Rainfall,factors.Temperature]; resultsChart.update();
 // recommendations
 const recs = [];
 if(n<40) recs.push('Nitrogen low ‚Äî apply balanced N fertilizer or organic compost.'); if(p<30) recs.push('Phosphorus low ‚Äî use DAP or rock phosphate.'); if(k<30) recs.push('Potassium low ‚Äî apply MOP.'); if(rain<100) recs.push('Low rainfall ‚Äî consider irrigation.'); if(temp<15||temp>35) recs.push('Suboptimal temperature ‚Äî protect crops.');
 const recList=document.getElementById('recommendList'); recList.innerHTML=''; if(recs.length===0) recList.innerHTML='<li>Conditions look optimal.</li>'; else recs.forEach(r=>{const li=document.createElement('li');li.textContent=r;recList.appendChild(li)});
}

document.getElementById('runPredict').addEventListener('click',()=>{runPredict();});

// voice input via Web Speech API (crop name)
const micBtn = document.getElementById('micBtn');
let recognizing=false; let recognition=null;
if('webkitSpeechRecognition' in window || 'SpeechRecognition' in window){ const SR = window.SpeechRecognition || window.webkitSpeechRecognition; recognition = new SR(); recognition.lang='en-US'; recognition.interimResults=false; recognition.maxAlternatives=1;
 recognition.onstart = ()=>{recognizing=true; micBtn.classList.add('pulse')}
 recognition.onend = ()=>{recognizing=false; micBtn.classList.remove('pulse')}
 recognition.onresult = (ev)=>{ const txt = ev.results[0][0].transcript; document.getElementById('cropInput').value = txt; }
 micBtn.addEventListener('click',()=>{ if(recognition){ if(recognizing){ recognition.stop(); } else { recognition.start(); } } else { alert('SpeechRecognition not supported in this browser') } })
} else { micBtn.addEventListener('click',()=>alert('Voice input not available. Use Chrome or Edge.')) }

// smooth scroll getStarted -> dashboard
document.getElementById('getStarted').addEventListener('click',()=>{document.getElementById('dashboard').scrollIntoView({behavior:'smooth'})})

// reveal on scroll
gsap.utils.toArray('.reveal').forEach(elem=>{gsap.from(elem,{opacity:0,y:30,duration:0.8,scrollTrigger:{trigger:elem, start:'top 80%'}})})

// mobile hamburger toggle
const hamb=document.getElementById('hamb'); hamb.addEventListener('click',()=>{ const navul=document.querySelector('#navList'); if(navul.style.display==='flex'){navul.style.display='none'}else{navul.style.display='flex'; navul.style.flexDirection='column'; navul.style.background='rgba(255,255,255,0.02)'; navul.style.padding='10px'; navul.style.position='absolute'; navul.style.right='20px'; navul.style.top='60px'} })

// initial animate NPK
gsap.to('#nBar',{width:document.getElementById('nVal').value+'%',duration:1.2});gsap.to('#pBar',{width:document.getElementById('pVal').value+'%',duration:1.2});gsap.to('#kBar',{width:document.getElementById('kVal').value+'%',duration:1.2});

// tiny navigation tracker follow tabs as user clicks
const tabEls = document.querySelectorAll('.tab'); tabEls.forEach((t,i)=>t.addEventListener('click',()=>{ const left = t.getBoundingClientRect().left - t.parentElement.getBoundingClientRect().left; gsap.to('.ai-indicator',{x:i*0}); }))

// small UI cleanup: make card spacing and chart containers neater
document.querySelectorAll('.glass').forEach(g=>{ g.style.padding = g.style.padding || '16px'; g.style.borderRadius = '12px' })
document.querySelectorAll('.chart-wrap, .glass canvas').forEach(c=>{ c.style.maxHeight = '280px' })

// fallback for side-farmer image: if the image fails to load, replace with a small inline SVG so the page still looks good
;(function(){
  const sideFarmerImg = document.querySelector('.side-farmer');
  if(!sideFarmerImg) return;
  // ensure pointer-events none so it doesn't interfere with UI
  sideFarmerImg.style.pointerEvents = 'none';
  sideFarmerImg.addEventListener('error', ()=>{
    try{
      const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
      svg.setAttribute('viewBox','0 0 64 64');
      svg.setAttribute('width','180');
      svg.setAttribute('height','auto');
      svg.style.width = sideFarmerImg.style.width || '180px';
      svg.style.height = 'auto';
      svg.style.position = 'fixed';
      svg.style.right = sideFarmerImg.style.right || '20px';
      svg.style.bottom = sideFarmerImg.style.bottom || '20px';
      svg.style.zIndex = '39';
      svg.innerHTML = '<circle cx="32" cy="14" r="10" fill="#2ecc71"/><rect x="12" y="28" width="40" height="26" rx="6" fill="#14532d"/>';
      sideFarmerImg.replaceWith(svg);
    }catch(e){ sideFarmerImg.style.display='none' }
  });
  // if image loaded but has zero width, trigger error handler
  sideFarmerImg.addEventListener('load', ()=>{ if(sideFarmerImg.naturalWidth===0) sideFarmerImg.dispatchEvent(new Event('error')) })
})();

// choose the best available hero background (prefer user JPGs) and tune overlay for photo backgrounds
(function(){
  const hero = document.querySelector('.hero');
  if(!hero) return;
  const candidates = [
    'assets/bg agri.jpg',
    'assets/ca59846685c58c8bb05d1d899a017276.jpg',
    'assets/agri-bg.svg'
  ];
  let i = 0;
  function tryLoad(){
    if(i >= candidates.length) return;
    const src = candidates[i];
    const tester = new Image();
    tester.onload = ()=>{
      // set as hero background (preserve existing overlay via ::before)
      hero.style.backgroundImage = `linear-gradient(180deg, rgba(4,8,6,0.0), rgba(4,8,6,0.0)), url('${src}')`;
      hero.style.backgroundSize = 'cover';
      hero.style.backgroundPosition = 'center';
      // if it's a raster photo, make overlay slightly darker for contrast
      if(/\.(jpg|jpeg|png)$/i.test(src)){
        document.body.classList.add('photo-bg');
        document.documentElement.style.setProperty('--hero-overlay-a','0.72');
        document.documentElement.style.setProperty('--hero-overlay-b','0.5');
      }
    };
    tester.onerror = ()=>{ i++; tryLoad(); };
    tester.src = src;
  }
  tryLoad();
})();

// try common farmer image filenames (png/jpg/svg) so user's farmer shows when available
(function(){
  const img = document.querySelector('.side-farmer');
  if(!img) return;
  const candidates = ['assets/farmer.png','assets/farmer.jpg','assets/farmer.svg'];
  let idx = 0;
  function tryNext(){
    if(idx >= candidates.length) return;
    const t = new Image();
    t.onload = ()=>{ img.src = candidates[idx]; };
    t.onerror = ()=>{ idx++; tryNext(); };
    t.src = candidates[idx];
  }
  tryNext();
})();

// High-resolution PDF export of dashboard using html2canvas + jsPDF
async function exportDashboardPDF() {
  try {
    const el = document.getElementById('dashboard');
    // render with higher scale for crispness
    const canvas = await html2canvas(el, { scale: 2, useCORS: true, backgroundColor: '#0e1410' });
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ unit: 'mm', format: 'a4' });
    const pageWidth = pdf.internal.pageSize.getWidth();
    const margin = 10;
    const usableWidth = pageWidth - margin * 2;
    const imgProps = pdf.getImageProperties(imgData);
    const imgWidth = usableWidth;
    const imgHeight = (imgProps.height * imgWidth) / imgProps.width;
    let y = margin;
    if (imgHeight > pdf.internal.pageSize.getHeight() - margin * 2) {
      // scale down if too tall
      const scale = (pdf.internal.pageSize.getHeight() - margin * 2) / imgHeight;
      pdf.addImage(imgData, 'PNG', margin, y, imgWidth * scale, imgHeight * scale);
    } else {
      pdf.addImage(imgData, 'PNG', margin, y, imgWidth, imgHeight);
    }
    const name = `AgriPredict_report_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')}.pdf`;
    pdf.save(name);
  } catch (err) {
    console.error('PDF export failed', err);
    alert('PDF export failed: ' + (err.message || err));
  }
}

document.getElementById('generatePdfBtn').addEventListener('click', ()=>{
  // disable while generating
  const btn = document.getElementById('generatePdfBtn'); btn.disabled = true; btn.textContent = 'Generating...';
  setTimeout(async ()=>{ await exportDashboardPDF(); btn.disabled = false; btn.innerHTML = 'üìÑ Generate PDF'; }, 100);
});

</script>
</body>
</html>